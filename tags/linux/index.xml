<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>linux on Matthew Croughan's Blog</title><link>https://blog.croughan.sh/tags/linux/</link><description>Recent content in linux on Matthew Croughan's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 11 Nov 2020 23:25:09 +0000</lastBuildDate><atom:link href="https://blog.croughan.sh/tags/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Lustrating My Frustrating Arch Install (De-Antergosifying)</title><link>https://blog.croughan.sh/posts/lustrating-arch/</link><pubDate>Wed, 11 Nov 2020 23:25:09 +0000</pubDate><guid>https://blog.croughan.sh/posts/lustrating-arch/</guid><description>lustrate
/ËˆlÊŒstreÉªt/
verb
purify by expiatory sacrifice, ceremonial washing, or some other ritual action. &amp;ldquo;a soul lustrated in the baptismal waters&amp;rdquo;
The Past (Thu 21 May 23:26:00 GMT 2020) 2 years ago, in 2018, I began using Linux for real. My distribution of choice was Antergos, an &amp;lsquo;easy button&amp;rsquo; Arch installer that was really popular at the time. The first package I added post-install apparently was synergy, a package to share my mouse/keyboard with my still-existing Windows 10 machine:</description><content>&lt;blockquote>
&lt;p>lustrate&lt;br>
/ËˆlÊŒstreÉªt/&lt;br>
&lt;em>verb&lt;/em>&lt;br>
purify by expiatory sacrifice, ceremonial washing, or some other ritual action.
&lt;em>&amp;ldquo;a soul lustrated in the baptismal waters&amp;rdquo;&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;h1 id="the-past-thu-21-may-232600-gmt-2020">The Past (Thu 21 May 23:26:00 GMT 2020)&lt;/h1>
&lt;p>2 years ago, in 2018, I began using Linux for real. My distribution of choice
was &lt;a href="https://en.wikipedia.org/wiki/Antergos">Antergos&lt;/a>, an &amp;lsquo;easy button&amp;rsquo; Arch
installer that was really popular at the time. The first package I added
post-install apparently was &lt;code>synergy&lt;/code>, a package to share my mouse/keyboard with
my still-existing Windows 10 machine:&lt;/p>
&lt;pre>&lt;code>matthew@thinkpad ~ $ head -n 3 /var/log/pacman.log
[2018-05-21 23:26] [PACMAN] Running 'pacman -S synergy'
[2018-05-21 23:26] [ALPM] transaction started
[2018-05-21 23:26] [ALPM] installed synergy (1.8.8-3)
&lt;/code>&lt;/pre>&lt;p>Little did I know that by choosing to use Antergos, I had already &lt;strong>infected my
future.&lt;/strong>&lt;/p>
&lt;h2 id="the-now-thu-12-nov-053830-gmt-2020">The Now (Thu 12 Nov 05:38:30 GMT 2020):&lt;/h2>
&lt;p>It&amp;rsquo;s 5AM. I have work tomorrow. What better way to spend my time than debugging
this crap? I love it.&lt;/p>
&lt;div class="collapsable-code">
&lt;input id="1" type="checkbox" checked />
&lt;label for="1">
&lt;span class="collapsable-code__language">PACMAN&lt;/span>
&lt;span class="collapsable-code__title">Full Output&lt;/span>
&lt;span class="collapsable-code__toggle" data-label-expand="Show" data-label-collapse="Hide">&lt;/span>
&lt;/label>
&lt;pre class="language-PACMAN" >&lt;code>
matthew@thinkpad ~ $ sudo pacman -Syu
:: Synchronising package databases...
core is up to date
extra is up to date
community is up to date
multilib is up to date
:: Starting full system upgrade...
:: Replace pygobject-devel with extra/python-gobject? [Y/n] y
:: Replace user-manager with extra/plasma-desktop? [Y/n] y
:: Replace xorg-luit with extra/luit? [Y/n] y
resolving dependencies...
looking for conflicting packages...
error: failed to prepare transaction (could not satisfy dependencies)
:: removing xorg-luit breaks dependency &amp;#39;xorg-luit&amp;#39; required by antergos-common-meta
:: removing user-manager breaks dependency &amp;#39;user-manager&amp;#39; required by antergos-kde-meta
&lt;/code>&lt;/pre>
&lt;/div>
&lt;p>&lt;code>:: removing xorg-luit breaks dependency 'xorg-luit' required by antergos-common-meta&lt;/code>&lt;/p>
&lt;p>&lt;code>:: removing user-manager breaks dependency 'user-manager' required by antergos-kde-meta&lt;/code>&lt;/p>
&lt;p>&lt;em>Agony.&lt;/em>&lt;/p>
&lt;p>&lt;a href="https://itsfoss.com/antergos-linux-discontinued/">When Antergos discontinued in May
2019&lt;/a>, I removed their mirrors
from &lt;code>/etc/pacman.conf&lt;/code>, which should have been enough. Everything had been fine
until now.&lt;/p>
&lt;h4 id="the-problem">The problem?&lt;/h4>
&lt;ol>
&lt;li>
&lt;p>The now dead and unmaintained
&lt;a href="https://wiki.archlinux.org/index.php/Meta_package_and_package_group">meta-package&lt;/a>
is causing &lt;a href="https://en.wikipedia.org/wiki/Dependency_hell">dependency hell&lt;/a> since
I did not remove it when Antergos died.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>My decision to use Antergos has screwed me 2 years later.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>I should have moved over to NixOS a long time ago.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="the-solution">The solution?&lt;/h4>
&lt;ol>
&lt;li>Simply remove the meta packages via &lt;code>pacman -Rdd&lt;/code>&lt;/li>
&lt;/ol>
&lt;pre>&lt;code>matthew@thinkpad ~ $ sudo pacman -Rdd antergos-kde-meta antergos-common-meta
Package (2) Old Version Net Change
antergos-common-meta 1.5-1 0.00 MiB
antergos-kde-meta 1.1-1 0.00 MiB
Total Removed Size: 0.01 MiB
:: Do you want to remove these packages? [Y/n]
&lt;/code>&lt;/pre>&lt;h4 id="the-result">The result?&lt;/h4>
&lt;p>ðŸ•’ 1 wasted hour.&lt;/p>
&lt;p>I did not know what meta-packages were, or the consequences of removing them.&lt;/p>
&lt;p>I can now update my Arch system. Hopefully there is no more Antergos cruft still
lingering in my system.&lt;/p>
&lt;p>Everything will be fine going forward, as long as:&lt;/p>
&lt;ul>
&lt;li>Power isn&amp;rsquo;t lost during upgrade&lt;/li>
&lt;li>I do not &lt;code>^C&lt;/code> the upgrade at an inopportune time&lt;/li>
&lt;li>Creation of the initramfs succeeds (&lt;a href="https://bugs.archlinux.org/task/54918">it&amp;rsquo;s weird
sometimes&amp;hellip;&lt;/a>)&lt;/li>
&lt;li>I do not run out of disk space&lt;/li>
&lt;/ul>
&lt;p>If any item from this list isn&amp;rsquo;t met, the system can fail to boot. Since updates
are not atomic in any way. The only way to recover from such a situation is
&lt;code>arch-chroot&lt;/code> on an external recovery boot image such as the Arch install media
itself.&lt;/p>
&lt;p>This has happened to me too many times on this install, I count a total of 5
times. Though, if anything, this is a testament to how recoverable bad
situations can be on Linux if you have the
&lt;a href="https://docstore.mik.ua/orelly/unix3/upt/ch14_03.htm">know-how&lt;/a>&lt;/p>
&lt;p>Stuff like this really makes me want to move to NixOS, where these issues don&amp;rsquo;t
exist, or at least simple rollback from failure states is easy and built in.&lt;/p></content></item></channel></rss>